# Planet cartography with neural learned regularization

## Introduction
Finding potential life harboring exo-Earths is one of the aims of exoplanetary
science with the use of future telescopes. Detecting signatures of life in exoplanets will 
likely first be accomplished by determining the bulk composition of the planetary atmosphere 
via reflected/transmitted spectroscopy. However, a complete understanding of the habitability conditions 
will surely require mapping the presence of liquid water, continents and/or clouds.
Spin-orbit tomography is a technique that allows us to obtain maps of the surface of
exoplanets around other stars using the light scattered by the planetary surface.

We leverage the enormous potential of deep learning and propose
a mapping technique for exo-Earths in which the regularization is learned from
mock surfaces. The solution of the inverse mapping problem is posed as a deep
neural network that can be trained end-to-end with suitable training data. Since we
still lack observational data of the surface albedo of exoplanets, we propose in this
work to use methods based on the procedural generation of planets, inspired
by what we found on Earth. We also consider mapping the recovery of surfaces and the presence
of persistent cloud in cloudy planets, a much more challenging problem.

We show that a reliable mapping can be carried out with our approach, producing
very compact continents, even when using single passband observations. More importantly, if 
exoplanets are partially cloudy like the Earth is, we show that one can potentially map the distribution of
persistent clouds that always occur on the same position on the surface (associated 
to orography and sea surface temperatures) together
with non-persistent clouds that move across the surface. This will become the first test one can 
perform on an exoplanet for the detection of an active climate system. For small rocky planets 
in the habitable zone of their stars, this weather system will be driven by water, and the 
detection can be considered as a strong proxy for
truly habitable conditions.

## Generating training and validation sets
The data for training can be generated by running `db_libnoise.py`. It will
generate modulation matrices, surface albedos and cloud covering maps.

## Training
Run `train_denoise.py` or `train_denoise_clouds.py` for training. These scripts accepts several variables. To
reproduce the results in the paper, we used:

    python train_denoise.py --model='conv1d' --k=15
    python train_denoise.py --model='conv2d' --k=15

## Dependencies for training

* Libnoise https://github.com/mhilker/libnoise-example
* `numpy`
* `zarr`
* `PyTorch` >v1.0
* OpenSimplex (`pip install opensimplex`)

## Dependencies for evaluation

* `numpy`
* `PyTorch` >v1.0